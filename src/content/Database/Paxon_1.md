---
title: "Paxon"
date: "2025-09-02"
category: "software"
subCategory: "Database"
tags: ["consistency", "system", "design","database"]
slug: "paxon"
---
###### 保證的是 "記錄的事實必定相同" 這件事情，不同節點 (DB Server) 資料(ID) 僅可以是 有/無 的差異

---

在古希臘的Paxon島上，有一個議會制政府。這個島上的議員們需要通過投票來決定各種法案和政策。但是這個政治體系面臨著一些現實挑戰：

1. 議員可能缺席：有些議員可能因為各種原因離開議會或無法參與投票

2. 通信不可靠：通過信使傳遞消息，可能會迷路、延遲送達和重複傳遞同樣的消息

3. 異步環境：沒有統一的時鐘，無法保證消息的送達順序

在不可靠的環境，如何讓議會就某個提案達成一致(簡單多數)的決定？

### 概念

上個月趙議員發起 **002號提案**：

「各位同仁，我想申請討論A路段修整的開工日期，這是002號提案申請。」

- 李議員：「好的我同意討論。我承諾在您的002號提案結束前，不接受編號更低的提案。」
- 但也有部分議員沒有接收到消息

但是趙議員後來因為生病，002號提案沒有進行到第二階段就中斷

__
<br>

今天林議員想發起提案，他不知道有 **002號提案** 狀況。

林議員：「各位同仁，我想申請討論A路段修整的開工日期，這是**001號提案**申請。」

- 王議員：「好的林議員，我同意討論。我這邊沒有其他相關提案記錄。我承諾在您的001號提案結束前，不接受編號更低的提案。」

*Promise(001, null)*

- *回覆：Promise(001, null)* 張議員：「好的林議員，我同意討論。雖然陳議員曾經在私下討論中提到『3月20日』這個想法，雖然沒有正式提案。我承諾支持您的001號提案。」

*Promise(001, null)*

- *回覆：* 李議員：「抱歉林議員，我必須拒絕。上個月趙議員的002號提案還沒有正式結束，基於議會流程，我不能接受您的提案。」

*Reject(002)*

__

<br>

林議員：「什麼？還有002號提案？那麼依規定我需要更高的編號！」

林議員：「各位同仁我重新申請：這是003號提案，討論A路段修整開工日期。」

- 王議員：「好的，003號比之前都大，我同意。」

*Promise(003, null)*

- 張議員：「我也同意003號提案」

*Promise(003, null)*

- 李議員：「003號比002號大，我可以接受。趙議員當時沒有提出具體日期就中斷了。」

*Promise(003, null)*

__

林議員：「我獲得了多數支持，而且對於結果都沒有意見，我可以提議自己原本想要的『3月15日』。」正式提案

- 張議員：「我接受003號提案。A路段開工日期：3月15日。」

*Accepted(003, "3月15日")*

- 李議員：「我接受003號提案。A路段開工日期：3月15日。」

*Accepted(003, "3月15日")*


<br>

林議員收到回覆後：「太好了！我有收到了2個接受回覆，超過半數了！」

書記員宣布：「根據一致決議，003號提案通過！A路段修整開工日期確定為『3月15日』。」


### 實務

通常應用在DB集群維護 Acceptor 節點，任一個DB收到寫入資料就可以視作是 Proposer，其他DB節點作為 Acceptor 參與共識決策。

- Proposer: 收到寫入請求的 DB 節點（動態角色）
- Acceptor: 集群中的所有 DB 節點（包括 Proposer 自己）
- Learner: 需要同步最終結果的節點，或客戶端應用

<br>

實際運作
1. 前端寫入請求 → DB-1
2. DB-1 變成 Proposer，向所有節點（包括自己）發起提案
3. 所有 DB 節點作為 Acceptor 回應是否接受
4. 達成多數決 後，寫入被確認
5. Learner 節點（如快取、備份系統）獲得最終結果