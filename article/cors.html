<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.BlKtvRjo.css" rel="stylesheet">
		<link href="../_app/immutable/assets/2.CzhWGdCx.css" rel="stylesheet">
		<link href="../_app/immutable/assets/4.D87DJdk2.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.CxaNDOXa.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C1CbXY1y.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/n9CujY7_.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BP3rl4Hc.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DMEj7IRU.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Z6cp3h9-.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.B5UVBtpa.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dp1pzeXC.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/oXeaZXhI.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/YtJmKh14.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/xsVDlqqI.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CgBhAJqo.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/B7Qc7Rs7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CqQaArfp.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.DcpHotp_.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/0GNeBg98.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/a5nURgyH.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/2.CIsQ7M89.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Dgv3LvGf.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BLR-JKVV.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CpIwvuco.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/4.DbyqfRzT.js">
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><div class="app svelte-1t5f27d"><header class="svelte-1wpzjs"><div class="title svelte-1wpzjs"></div></header><!----> <main class="svelte-1t5f27d"><!--[--><!----><div class="article-layout svelte-10kcmdg"><aside class="svelte-10kcmdg"><nav class="svelte-h5mjvk"><h2 class="svelte-h5mjvk"><a href="../article" class="nav-heading-link">æ–‡ç« åˆ—è¡¨</a></h2> <!--[--><section><button class="category-toggle">Software</button> <!--[!--><!--]--></section><!--]--></nav><!----></aside> <main class="svelte-10kcmdg"><!----><!----><!--[--><article class="prose mx-auto"><div class="article-header svelte-mdkbyj"><h1 class="svelte-mdkbyj">CORS &amp; SOP</h1> <p class="svelte-mdkbyj">2025-10-27</p></div> <section class="article-body svelte-mdkbyj"><!----><h2>å¸¸å¸¸çœ‹åˆ° CORS ä»Šå¤©æ‰çŸ¥é“æœ‰ SOP</h2> <p>ç€è¦½å™¨åŸç”Ÿå°±æœ‰ä¸€å€‹é è¨­çš„å®‰å…¨æ©Ÿåˆ¶å«åš <code>Same-Origin Policy (SOP)</code>ï¼Œå®ƒåªå…è¨±ç¶²é æ¥æ”¶ä¾†è‡ªç›¸åŒä¾†æºï¼ˆSame Originï¼‰çš„è³‡æ–™ã€‚</p> <p>é€™å€‹é™åˆ¶åœ¨å¯¦å‹™ä¸Šæœƒé€ æˆä¸€äº›ä¸ä¾¿ï¼šå¦‚æœå‰å¾Œç«¯åˆ†åˆ¥éƒ¨ç½²åœ¨ä¸åŒçš„ Server ä¸Šï¼Œå‰ç«¯å°±ç„¡æ³•ç›´æ¥å‘å¾Œç«¯ç™¼é€è«‹æ±‚å–å¾—è³‡æ–™ã€‚å‚³çµ±çš„è§£æ±ºæ–¹å¼æ˜¯è®“å¾Œç«¯å…ˆæ¥æ”¶å¤–éƒ¨è³‡æ–™ï¼Œå†è½‰ç™¼çµ¦å‰ç«¯ã€‚</p> <p>ç‚ºäº†çªç ´é€™å€‹é™åˆ¶ï¼Œè®“è·¨ä¾†æºçš„è³‡æ–™äº¤æ›æ›´æ–¹ä¾¿ï¼Œ<code>CORSï¼ˆCross-Origin Resource Sharingï¼‰</code> æ©Ÿåˆ¶å› æ­¤èª•ç”Ÿã€‚</p> <h3>Same-Origin Policy</h3> <p>ä¸»è¦ç”¨ä¾†é˜²ç¯„ <strong>è·¨ç«™è«‹æ±‚å½é€ ï¼ˆCSRFï¼‰</strong> ç­‰æ”»æ“Šã€‚ç”±æ–¼ç€è¦½å™¨ç™¼é€è«‹æ±‚æ™‚æœƒè‡ªå‹•å¸¶ä¸Šç•¶å‰ç¶²ç«™çš„ Originï¼Œä¸” JavaScript ç„¡æ³•éš¨æ„å½é€ é€™å€‹å€¼ï¼Œå› æ­¤ SOP å¯ä»¥æœ‰æ•ˆé˜²æ­¢æƒ¡æ„ç¶²ç«™å†’ç”¨ä½¿ç”¨è€…èº«ä»½ã€‚</p> <p>å‡è¨­ä½ ç™»å…¥äº†éŠ€è¡Œç¶²ç«™ Aï¼Œæ­¤æ™‚ç€è¦½å™¨æœƒå„²å­˜ A ç¶²ç«™çš„ Cookieï¼ˆåŒ…å«ç™»å…¥æ†‘è­‰ï¼‰ã€‚å¦‚æœæ²’æœ‰ SOP ä¿è­·ï¼Œç•¶ä½ è¨ªå•æƒ¡æ„ç¶²ç«™ B æ™‚ï¼ŒB ç¶²ç«™çš„ JavaScript å°±èƒ½å‘ A éŠ€è¡Œç™¼é€è«‹æ±‚ï¼Œä¸¦è‡ªå‹•å¸¶ä¸Šä½ çš„ç™»å…¥ Cookieï¼Œé€²è€Œç›œå–è³‡æ–™æˆ–é€²è¡Œè½‰å¸³ã€‚æœ‰äº† SOPï¼Œç€è¦½å™¨æœƒé˜»æ“‹ B ç¶²ç«™è®€å–ä¾†è‡ª A ç¶²ç«™çš„å›æ‡‰è³‡æ–™ã€‚</p> <pre class="language-md"><!----><code class="language-md">    B ç¶²ç«™çš„ JS ç™¼èµ·è«‹æ±‚åˆ° A Server
            â†“
    ç€è¦½å™¨æª¢æŸ¥:
    ã€ŒB çš„ originã€ vs ã€ŒA çš„ originã€
            â†“
        æ˜¯å¦åŒæº?
    (Yes)      (No)
    ç›´æ¥ç™¼é€    é€²å…¥ CORS æµç¨‹
    æ­£å¸¸è®€å–</code><!----></pre> <h3>Cross-Origin Resource Sharing</h3> <p>ç•¶é€²å…¥ CORS æµç¨‹æ™‚ï¼Œç€è¦½å™¨æœƒå…ˆæª¢æŸ¥è©²è«‹æ±‚æ˜¯ç°¡å–®è«‹æ±‚é‚„æ˜¯é æª¢è«‹æ±‚ã€‚</p> <p>ç‚ºä»€éº¼è¦åˆ†å…©ç¨®è«‹æ±‚ï¼Ÿä¸»è¦æ˜¯ç‚ºäº†ä¿è­·èˆŠçš„å¾Œç«¯ä¼ºæœå™¨ã€‚ç°¡å–®è«‹æ±‚é€šå¸¸åªæ˜¯è®€å–è³‡æ–™ï¼Œæ¯”è¼ƒå®‰å…¨ï¼Œå¯ä»¥ç›´æ¥é€å‡ºã€‚ä½†å¦‚æœæ˜¯å¯èƒ½ä¿®æ”¹è³‡æ–™çš„è«‹æ±‚ï¼ˆå¦‚ PUTã€DELETEï¼‰æˆ–å¸¶æœ‰è‡ªè¨‚ Headerï¼Œå°±éœ€è¦å…ˆç”¨é æª¢ç¢ºèªå¾Œç«¯æœ‰æ”¯æ´ CORSï¼Œé¿å…å°ä¸æ”¯æ´çš„èˆŠä¼ºæœå™¨é€ æˆæ„å¤–å½±éŸ¿ã€‚</p> <p><strong>ç°¡å–®è«‹æ±‚ (Simple Request)</strong></p> <p>ç¬¦åˆä»¥ä¸‹æ¢ä»¶çš„è«‹æ±‚æœƒè¢«è¦–ç‚ºç°¡å–®è«‹æ±‚ï¼š</p> <ul><li>HTTP Method ç‚º <code>GET</code>ã€<code>HEAD</code> æˆ– <code>POST</code></li> <li>Content-Type åªèƒ½æ˜¯ <code>application/x-www-form-urlencoded</code>ã€<code>multipart/form-data</code> æˆ– <code>text/plain</code></li> <li>æ²’æœ‰è‡ªè¨‚çš„ Header</li></ul> <p>ç°¡å–®è«‹æ±‚æœƒç›´æ¥é€å‡ºï¼Œä¼ºæœå™¨é€éå›æ‡‰ Header å‘ŠçŸ¥ç€è¦½å™¨æ˜¯å¦å…è¨±è©²è·¨ä¾†æºè«‹æ±‚ã€‚</p> <p><strong>é æª¢è«‹æ±‚ (Preflight Request)</strong></p> <p>ä¸ç¬¦åˆç°¡å–®è«‹æ±‚æ¢ä»¶çš„è«‹æ±‚ï¼Œç€è¦½å™¨æœƒå…ˆç™¼é€ä¸€å€‹ <code>OPTIONS</code> æ–¹æ³•çš„é æª¢è«‹æ±‚ï¼Œè©¢å•ä¼ºæœå™¨æ˜¯å¦å…è¨±å¯¦éš›è«‹æ±‚ã€‚åªæœ‰ç•¶é æª¢é€šéå¾Œï¼Œæ‰æœƒç™¼é€çœŸæ­£çš„è«‹æ±‚ã€‚</p> <pre class="language-md"><!----><code class="language-md">    ç€è¦½å™¨ç™¼é€ OPTIONS è«‹æ±‚
            â†“
    ä¼ºæœå™¨æª¢æŸ¥ä¸¦å›æ‡‰ CORS Headers
            â†“
        é æª¢æ˜¯å¦é€šé?
    (Yes)         (No)
    ç™¼é€å¯¦éš›è«‹æ±‚    é˜»æ“‹è«‹æ±‚
    å–å¾—å›æ‡‰      é¡¯ç¤º CORS éŒ¯èª¤</code><!----></pre> <p><strong>å¸¸è¦‹çš„ CORS Headers</strong></p> <p>ä¼ºæœå™¨ç«¯éœ€è¦è¨­å®šçš„ä¸»è¦ Headersï¼š</p> <ul><li><code>Access-Control-Allow-Origin</code>: æŒ‡å®šå…è¨±çš„ä¾†æºï¼Œå¯è¨­ç‚ºç‰¹å®šç¶²åŸŸæˆ– <code>*</code>ï¼ˆæ‰€æœ‰ä¾†æºï¼‰</li> <li><code>Access-Control-Allow-Methods</code>: å…è¨±çš„ HTTP æ–¹æ³•ï¼Œå¦‚ <code>GET, POST, PUT, DELETE</code></li> <li><code>Access-Control-Allow-Headers</code>: å…è¨±çš„è‡ªè¨‚ Headers</li> <li><code>Access-Control-Allow-Credentials</code>: æ˜¯å¦å…è¨±æ”œå¸¶æ†‘è­‰ï¼ˆå¦‚ Cookieï¼‰</li> <li><code>Access-Control-Max-Age</code>: é æª¢è«‹æ±‚çš„å¿«å–æ™‚é–“ï¼ˆç§’ï¼‰</li></ul> <p><strong>ç¯„ä¾‹è¨­å®š</strong></p> <pre class="language-javascript"><!----><code class="language-javascript"><span class="token comment">// Node.js Express ç¯„ä¾‹</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Origin'</span><span class="token punctuation">,</span> <span class="token string">'https://example.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Methods'</span><span class="token punctuation">,</span> <span class="token string">'GET, POST, PUT, DELETE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Headers'</span><span class="token punctuation">,</span> <span class="token string">'Content-Type, Authorization'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Credentials'</span><span class="token punctuation">,</span> <span class="token string">'true'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>method <span class="token operator">===</span> <span class="token string">'OPTIONS'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">sendStatus</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><!----></pre> <p>åˆ†å…©ç¨®è«‹æ±‚ä¸»è¦æ˜¯ä¿è­·èˆŠçš„å¾Œç«¯ä¼ºæœå™¨ã€‚ç°¡å–®è«‹æ±‚é€šå¸¸åªæ˜¯è®€å–è³‡æ–™ï¼Œå¯ä»¥ç›´æ¥é€å‡ºã€‚ä½†å¦‚æœæ˜¯å¯èƒ½ä¿®æ”¹è³‡æ–™çš„è«‹æ±‚ï¼ˆå¦‚ PUTã€DELETEï¼‰æˆ–å¸¶æœ‰è‡ªè¨‚ Headerï¼Œå°±éœ€è¦å…ˆç”¨é æª¢ç¢ºèªå¾Œç«¯æœ‰æ”¯æ´ CORSï¼Œé¿å…å°ä¸æ”¯æ´çš„èˆŠä¼ºæœå™¨é€ æˆæ„å¤–å½±éŸ¿ã€‚</p> <p><strong>å¯¦éš›æ¸¬è©¦ CORS</strong></p> <p>æ¶å¥½å¾Œç«¯å¾Œï¼Œç”¨ç€è¦½å™¨æ‰“é–‹ä»»æ„ç¶²ç«™ï¼ˆä¾‹å¦‚ <code>https://policy.medium.com/medium-terms-of-service-9db0094a1e0f</code>ï¼‰ï¼Œé–‹å•Ÿé–‹ç™¼è€…å·¥å…·çš„ä¸»æ§å°åŸ·è¡Œï¼š</p> <pre class="language-js"><!----><code class="language-js"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://127.0.0.1:8080/api'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">r</span> <span class="token operator">=></span> r<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span></code><!----></pre> <p>æ­¤æ™‚å‰ç«¯æœƒçœ‹åˆ° CORS éŒ¯èª¤ï¼Œä½†å¦‚æœè§€å¯Ÿå¾Œç«¯ Logï¼Œæœƒç™¼ç¾è«‹æ±‚æœ‰æˆåŠŸä¸¦å›æ‡‰ï¼Œåªæ˜¯ç€è¦½å™¨é˜»æ“‹äº†å›æ‡‰ã€‚</p> <p>å›åˆ°ç€è¦½å™¨åˆ‡æ›åˆ°ã€Œç¶²è·¯ã€é¢æ¿ï¼Œæ‰¾åˆ°é€™å€‹è«‹æ±‚ï¼ŒæŸ¥çœ‹ã€Œè¦æ±‚æ¨™é ­ã€ä¸­çš„ <code>Origin</code> æ¬„ä½ï¼ˆä¾‹å¦‚ <code>https://policy.medium.com</code>ï¼‰é€™å°±æ˜¯ç€è¦½å™¨è‡ªå‹•å¸¶ä¸Šçš„ä¾†æºç¶²åŸŸã€‚å›åˆ°å¾Œç«¯ç¨‹å¼ç¢¼ï¼ŒåŠ ä¸Šå…è¨±çš„ä¾†æºä¸¦é‡å•Ÿï¼š</p> <pre class="language-golang"><!----><code class="language-golang">w.Header().Set(&quot;Access-Control-Allow-Origin&quot;, &quot;https://policy.medium.com&quot;) // å…è¨±ç‰¹å®šç¶²åŸŸ
w.Header().Set(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;) // å…è¨±æ‰€æœ‰ä¾†æº</code><!----></pre> <p>é‡æ–°åŸ·è¡Œ fetchï¼Œå°±å¯ä»¥æˆåŠŸå–å¾—è³‡æ–™äº†ã€‚</p> <p><strong>å®Œæ•´ç¨‹å¼ç¢¼</strong></p> <pre class="language-golang"><!----><code class="language-golang">// golang
package main 

import (
	&quot;fmt&quot;
	&quot;net/http&quot;
)

func main() &#123;
	fmt.Println(&quot;=== HTTP ä¼ºæœå™¨ (å…è¨± CORS) ===&quot;)
	fmt.Println()
	fmt.Println(&quot;âœ“ ä¼ºæœå™¨å·²å•Ÿå‹•&quot;)
	fmt.Println(&quot;â”œâ”€ ç›£è½åœ°å€: http://127.0.0.1:8080&quot;)
	fmt.Println(&quot;â”œâ”€ CORS: å·²å•Ÿç”¨ âœ“&quot;)
	fmt.Println(&quot;â””â”€ åœ¨ç€è¦½å™¨æ‰“é–‹é€™å€‹ç¶²å€ï¼Œç„¶å¾Œåœ¨ Console åŸ·è¡Œ fetch&quot;)
	fmt.Println()

	// å®šç¾©è·¯ç”± - ä¸»é 
	http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) &#123;
		fmt.Println(&quot;=== æ”¶åˆ°ç€è¦½å™¨è«‹æ±‚ ===&quot;)
		fmt.Println(&quot;è«‹æ±‚æ–¹æ³•:&quot;, r.Method)
		fmt.Println(&quot;è«‹æ±‚è·¯å¾‘:&quot;, r.URL.Path)
		fmt.Println(&quot;å®¢æˆ¶ç«¯åœ°å€:&quot;, r.RemoteAddr)
		fmt.Println()

		response := &#96;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;TCP Server Response&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;container&quot;&gt;
        &lt;h1&gt;ğŸ‰ é€£æ¥æˆåŠŸï¼&lt;/h1&gt;
        &lt;p class=&quot;success&quot;&gt;âœ“ Server received your message!&lt;/p&gt;
        
        &lt;div class=&quot;info&quot;&gt;
            &lt;h3&gt;ä½ ç¾åœ¨å¯ä»¥åšä»€éº¼:&lt;/h3&gt;
            &lt;ul&gt;
                &lt;li&gt;æŒ‰ F12 æ‰“é–‹é–‹ç™¼è€…å·¥å…·&lt;/li&gt;
                &lt;li&gt;æ‰“é–‹ Network é¢æ¿&lt;/li&gt;
                &lt;li&gt;é»æ“Šä¸‹é¢çš„æŒ‰éˆ•ç™¼é€ API è«‹æ±‚&lt;/li&gt;
                &lt;li&gt;åœ¨ Network é¢æ¿çœ‹åˆ°è«‹æ±‚&lt;/li&gt;
                &lt;li&gt;åœ¨ Console çœ‹åˆ°å›æ‡‰&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;

        &lt;button onclick=&quot;testAPI()&quot;&gt;ğŸ”— ç™¼é€ API è«‹æ±‚&lt;/button&gt;
        &lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;

    &lt;script&gt;
        function testAPI() &#123;
            document.getElementById(&quot;result&quot;).textContent = &quot;æ­£åœ¨ç™¼é€è«‹æ±‚...&quot;;
            
            fetch(&#39;http://127.0.0.1:8080/api&#39;, &#123;
                method: &#39;GET&#39;,
                headers: &#123;
                    &#39;X-Custom-Token&#39;: &#39;my-secret-123&#39;,
                    &#39;Content-Type&#39;: &#39;application/json&#39;
                &#125;
            &#125;)
            .then(response =&gt; &#123;
                console.log(&quot;å›æ‡‰ç‹€æ…‹:&quot;, response.status);
                console.log(&quot;å›æ‡‰ Headers:&quot;, response.headers);
                return response.json();
            &#125;)
            .then(data =&gt; &#123;
                console.log(&quot;å›æ‡‰æ•¸æ“š:&quot;, data);
                document.getElementById(&quot;result&quot;).textContent = 
                    &quot;âœ“ æˆåŠŸï¼&#92;n&#92;nå›æ‡‰:&#92;n&quot; + JSON.stringify(data, null, 2);
            &#125;)
            .catch(error =&gt; &#123;
                console.error(&quot;âŒ å¤±æ•—:&quot;, error);
                document.getElementById(&quot;result&quot;).textContent = 
                    &quot;âŒ å¤±æ•—: &quot; + error.message;
            &#125;);
        &#125;
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
		&#96;
		w.Header().Set(&quot;Content-Type&quot;, &quot;text/html; charset=utf-8&quot;)
		w.WriteHeader(http.StatusOK)
		fmt.Fprint(w, response)
	&#125;)

	// ã€é‡è¦ã€‘æ·»åŠ  CORS ä¸­é–“ä»¶
	corsMiddleware := func(next http.Handler) http.Handler &#123;
		return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) &#123;
			// ã€è¨­ç½® CORS Headersã€‘
			w.Header().Set(&quot;Access-Control-Allow-Origin&quot;, &quot;éš¨æ„æ·»åŠ ä½ æƒ³æ¸¬è©¦çš„ç¶²å€&quot;)
			w.Header().Set(&quot;Access-Control-Allow-Methods&quot;, &quot;GET, POST, PUT, DELETE, OPTIONS&quot;)
			w.Header().Set(&quot;Access-Control-Allow-Headers&quot;, &quot;Content-Type, X-Custom-Token, Authorization&quot;)

			// è™•ç† OPTIONS é æª¢è«‹æ±‚
			if r.Method == &quot;OPTIONS&quot; &#123;
				w.WriteHeader(http.StatusOK)
				return
			&#125;

			next.ServeHTTP(w, r)
		&#125;)
	&#125;

	// API ç«¯é»
	http.HandleFunc(&quot;/api&quot;, func(w http.ResponseWriter, r *http.Request) &#123;
		fmt.Println(&quot;=== æ”¶åˆ° API è«‹æ±‚ ===&quot;)
		fmt.Println(&quot;æ–¹æ³•:&quot;, r.Method)
		fmt.Println(&quot;è·¯å¾‘:&quot;, r.URL.Path)
		fmt.Println(&quot;Header &#39;X-Custom-Token&#39;:&quot;, r.Header.Get(&quot;X-Custom-Token&quot;))
		fmt.Println()

		w.Header().Set(&quot;Content-Type&quot;, &quot;application/json; charset=utf-8&quot;)
		w.WriteHeader(http.StatusOK)

		response := &#96;&#123;
  &quot;message&quot;: &quot;Hello from Server!&quot;,
  &quot;status&quot;: &quot;success&quot;,
  &quot;timestamp&quot;: &quot;2025-10-28T08:00:00Z&quot;,
  &quot;receivedHeader&quot;: &quot;&#96; + r.Header.Get(&quot;X-Custom-Token&quot;) + &#96;&quot;
&#125;&#96;
		fmt.Fprint(w, response)
	&#125;)

	fmt.Println(&quot;ä¼ºæœå™¨æ­£åœ¨ç›£è½ :8080&quot;)
	fmt.Println(&quot;æ‰“é–‹ç€è¦½å™¨: http://127.0.0.1:8080&quot;)
	fmt.Println()

	// ã€ä½¿ç”¨ CORS ä¸­é–“ä»¶ã€‘
	http.ListenAndServe(&quot;:8080&quot;, corsMiddleware(http.DefaultServeMux))
&#125;</code><!----></pre><!----></section></article><!--]--><!----><!----></main></div><!----><!--]--><!----></main></div><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_1w5xtp2 = {
						base: new URL("..", location).pathname.slice(0, -1),
						assets: "/svelte-blog"
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.CxaNDOXa.js"),
						import("../_app/immutable/entry/app.B5UVBtpa.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 4],
							data: [null,null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
