<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<link href="../_app/immutable/assets/0.BlKtvRjo.css" rel="stylesheet">
		<link href="../_app/immutable/assets/2.CzhWGdCx.css" rel="stylesheet">
		<link href="../_app/immutable/assets/4.D87DJdk2.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.Bd1-C6zb.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BDgcA7-7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/COc0ozwQ.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CR_4RHM7.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/smy7oK8t.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BjM09ad5.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.CCiVQQWt.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/1-kU2YTO.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Cew64nlL.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CYQQZ9Kc.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/dbPvbsOE.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.BRYCuTr9.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/C5SEx9ip.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/xmhPVyN0.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/2.uqY18p7g.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/3ot0CaDB.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/E12KXTb-.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/4.B-vq05xQ.js">
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents"><!--[--><!--[--><!----><div class="app svelte-1t5f27d"><header class="svelte-1wpzjs"><div class="title svelte-1wpzjs">Blog</div></header><!----> <main class="svelte-1t5f27d"><!--[--><!----><div class="article-layout svelte-10kcmdg"><aside class="svelte-10kcmdg"><nav class="svelte-h5mjvk"><h2 class="svelte-h5mjvk"><a href="../article" class="nav-heading-link">文章列表</a></h2> <!--[--><section><button class="category-toggle">Software</button> <!--[!--><!--]--></section><!--]--></nav><!----></aside> <main class="svelte-10kcmdg"><!----><!----><!--[--><article class="prose mx-auto"><div class="article-header svelte-mdkbyj"><h1 class="svelte-mdkbyj">Svelte Blog</h1> <p class="svelte-mdkbyj">2025-05-05</p></div> <section class="article-body svelte-mdkbyj"><!----><h6>用 Svelte 做一個類似 Jekyll 的靜態生成網站 (你正在閱讀的)，提供 <a href="https://github.com/cao0085/svelte-blog" rel="nofollow">Repository</a></h6> <hr/> <p>我第一個程式專案就是套Jekyll + GitHub Pages 來部屬網站，朋友推薦可以玩玩看 Svelte，就想說順手把Blog 搬過來，再加上聽說靜態頁面搜尋引擎會比較友善，決定拿來就架一個文章模板網站試試。</p> <h3>前端用混合式靜態預渲染</h3> <ul><li>CSR（Client-Side Rendering）：客戶端動態載入 Markdown 轉換的 Svelte 組件</li> <li>SSG（Static Site Generation）：構建時預渲染所有文章頁面</li></ul> <pre class="language-markdown"><!----><code class="language-markdown">檔案系統對應：
src/routes/
├── +layout.svelte              # 全局布局（Header）
└── article/                    # 子路由目錄
    ├── +layout.svelte          # 文章專用布局（側邊欄 + 內容區）
    ├── +page.svelte            # /article 列表頁
    └── [slug]/                 # 動態路由段落
        ├── +page.svelte        # 文章內容頁（渲染組件）
        └── +page.ts            # 預渲染配置</code><!----></pre> <pre class="language-markdown"><!----><code class="language-markdown">構建階段 (npm run build)
  ↓
掃描 src/content/*<span class="token italic"><span class="token punctuation">*</span><span class="token content">/</span><span class="token punctuation">*</span></span>.md
  ↓
提取每個 Markdown 的 metadata.slug
  ↓
生成對應的靜態 HTML 頁面
  ↓
輸出到 build/blog/&#123;slug&#125;.html</code><!----></pre> <p>也就是說構建(打包)時，SvelteKit 會：</p> <ol><li>從 <code>+page.ts</code> 的 <code>entries()</code> 函數取得所有文章的 slug 列表</li> <li>為每個 slug 預渲染一個靜態 HTML 檔案（例如：<code>build/blog/db_sql.html</code>）</li> <li>這些檔案路徑與 URL 路徑完全對應（<code>/article/db_sql</code> → <code>blog/db_sql.html</code>）</li></ol> <p>使用者訪問時：</p> <ol><li>瀏覽器請求 <code>/article/db_sql</code></li> <li>伺服器直接回傳已經預渲染好的 <code>blog/db_sql.html</code>（含完整內容）</li> <li>頁面載入後，SvelteKit 接管路由（Hydration），後續點擊文章連結變成客戶端導航</li></ol> <h3>自動化流程</h3> <p>因為應用是單純的文字紀錄，所以設計成每次 Push 到 Master 就可以用 Github Action 自動執行打包，然後輸出檔案放在另一個分支。</p> <ul><li>master (主程式碼)</li> <li>gh-pages (打包檔案)</li></ul> <p>根目錄配置 /.github/workflows/deploy.yml</p> <pre class="language-yml"><!----><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy to GitHub Pages

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> master

<span class="token key atrule">permissions</span><span class="token punctuation">:</span>
  <span class="token key atrule">contents</span><span class="token punctuation">:</span> write  <span class="token comment"># ⬅加上這行，否則會 403 push error</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build-and-deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest

    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout repo
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v3

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Setup Node
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@v3
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">node-version</span><span class="token punctuation">:</span> <span class="token number">20</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install dependencies
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm ci

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build the site
        <span class="token key atrule">run</span><span class="token punctuation">:</span>  npm run build
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token key atrule">NODE_ENV</span><span class="token punctuation">:</span> production

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy to GitHub Pages
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> peaceiris/actions<span class="token punctuation">-</span>gh<span class="token punctuation">-</span>pages@v4
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">github_token</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.GITHUB_TOKEN <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
          <span class="token key atrule">publish_dir</span><span class="token punctuation">:</span> ./build
          <span class="token key atrule">publish_branch</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages
          <span class="token key atrule">cname</span><span class="token punctuation">:</span> blog.yoshikagehub.com</code><!----></pre> <h3>部屬</h3> <p>之前都是用 Github Pages 直接用，這次因為路徑想改用 CloudFlare 上買的 Domain ，所以改成用 CloudFlare 連接 Github Repository 指定分支，那 CloudFlare 就會自動路由</p><!----></section></article><!--]--><!----><!----></main></div><!----><!--]--><!----></main></div><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_81d9q7 = {
						base: new URL("..", location).pathname.slice(0, -1),
						assets: "/svelte-blog"
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.Bd1-C6zb.js"),
						import("../_app/immutable/entry/app.CCiVQQWt.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 4],
							data: [null,null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
